#!/bin/bash

echo "Current directory: $(pwd)"
# exit 0

# golangci-lint の実行
echo ""
echo "_____________________________________"
echo "Running golangci-lint..."
# ./backend/bin/golangci-lint run ./backend/...
make golint
if [ $? -ne 0 ]; then
	echo "golangci-lint failed. Commit aborted."
	exit 1
fi

# staticcheck の実行
echo ""
echo "_____________________________________"
echo "Running staticcheck..."
make staticcheck
if [ $? -ne 0 ]; then
	echo "staticcheck failed. Commit aborted."
	exit 1
fi

# # deadcode の実行
# echo ""
# echo "_____________________________________"
# echo "Running deadcode..."
# make deadcode
# if [ $? -ne 0 ]; then
# 	echo "deadcode failed. Commit aborted."
# 	exit 1
# fi

# gosec の実行
echo ""
echo "_____________________________________"
echo "Running gosec..."
make gosec
if [ $? -ne 0 ]; then
	echo "gosec detected issues. Commit aborted."
	exit 1
fi

echo "All checks passed. Proceeding with commit."
exit 0
